<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>
<style>
* {
	font-family: monospace;
}
body {
		background-color: black;
		color: #a31d1d;
}
ul {
    list-style: none;
    padding-left: 0;
}
hr {
    border-color: black;
    background-color: black;
    color: black;
    height: 1px;
    border: 0;
}
input[type=text], input[type=text]:focus {
	border: none;
	outline: none;
  background-color: black;
  color: #a31d1d;
  padding-left: 0;
}
::placeholder { /* Chrome, Firefox, Opera, Safari 10.1+ */
  color: black;
  opacity: 1; /* Firefox */
}

:-ms-input-placeholder { /* Internet Explorer 10-11 */
  color: black;
}

::-ms-input-placeholder { /* Microsoft Edge */
  color: black;
}
.result {
margin-bottom: 0;
}
  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: repeating-linear-gradient(
  to bottom,
  #55CDFC,
  #55CDFC 20px,
  #F7A8B8 20px,
  #F7A8B8 40px,
  #FFFFFF 40px,
  #FFFFFF 60px
);
    opacity: 0.7;
    pointer-events: none;
    mix-blend-mode: multiply;
    display: none;
  }
</style>

<body>
  <div class="overlay"></div>
	<div class="window">
		<ul class="result">
		  <li class="ready">not Microsoft Windows [Version 0.0.1]
			<br>(c) 2022 not Microsoft Corporation. All rights reserved.</li>
      <br>
		</ul>
		
		<div class="command-area">
		  <label for="command-input" id="dirname">C:\Users\waiting...></label>
		  <input type="text" id="command-input" class="command" placeholder="type command here…" />
		</div>
	  </div>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>

var userName;

function getUsername(callback) {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      var visits = JSON.parse(this.responseText).info.views;
      userName = visits;
      
      path = "C:\\Users\\" + userName + "> ";

      document.getElementById("dirname").innerHTML = "C:\\Users\\" + userName + ">";
      document.getElementById("command-input").focus();

      if (typeof callback === "function") {
        callback();
      }
    }
  };
  xhttp.open("GET", "https://weirdscifi.ratiosemper.com/neocities.php?sitename=sep", true);
  xhttp.send();
}

window.onload = function() {
  getUsername(function() {
    console.log("Username:", userName);
  });
};

function getInput() {
  command = commandInput.value;
  return command;
}

function attachCommand() {
  var li = document.createElement('li');
  li.textContent = getInput();

  var span = document.createElement('span');
  span.className = 'path';
  span.textContent = path;

  li.insertBefore(span,li.firstChild);
  
  result.appendChild(li);
}

function changeTextColor(color) {
    var elements = document.querySelectorAll('body, ul, hr, input[type=text]');
    
    elements.forEach(function(element) {
        element.style.color = color;
    });
}


function returnResponse() {
  var li = document.createElement('li');
  
  var anstest = document.getElementById('command-input').value;

if (anstest == "help") {
	li.innerHTML = `
<li>For more information on a specific command, type HELP command-name</li>
<li>help       this thing duh</li>
<li>index      home page</li>
<li>about      about the site</li>
<li>c          change the colour of the UI. eg "c red" or "c #345093"</li>
<li>c trans    try it ;)</li>
<li>hello      </li>
  <hr>
  <li>For more information on tools see the command-line reference in the online help.</li>
  <hr>
	`;
}
else if (anstest == "index") {
	li.innerHTML = 
  `welcome to my command line. 
  <br><img src="images/bread.gif"><hr>
  `;
}
else if (anstest == "about") {
	li.innerHTML = 
  `i dont consider myself that creative of a person, as reflected by this site. its pretty generic and looks too similar to the default windows terminal.
  <br>created may 2022<hr>`;
}
else if (anstest == "hello") {
	li.innerHTML = 'hi! <hr>';
}
else if (anstest.startsWith("c ")) {
        var colorCode = anstest.substring(2);
        if (colorCode == "trans") {
          $('.overlay').css("display", "block");
          changeTextColor("white")
          li.innerHTML = 'woohooo!!! #Transrightsarehumanrights <hr>';
        } else {
          $('.overlay').css("display", "none");
        changeTextColor(colorCode);
        li.innerHTML = 'Text color changed. <hr>';
        }
}
else {
	li.innerHTML = "'" + anstest + "'" + ' is not recognized as an internal or external command, operable program or batch file. <hr>';
}
  
  result.appendChild(li);
}

function repeatInput() {
  commandInput.value = command;
}

function scrollToBottom() {
  result.scrollTop = result.scrollHeight;
}

function doTheThing() {
  if(getInput().trim() !== '') {
    attachCommand();
    returnResponse();
    scrollToBottom();
  }
  
  commandInput.value = '';
}

var commandInput = document.getElementById('command-input'),
    result = document.querySelector('.result'),
    command = '',
    path = "C:\\Users\\" + userName + "> ";
    console.log(path)

commandInput.addEventListener('keydown',function(e){
  if(e.keyCode === 13) doTheThing();
  if(e.keyCode === 38) repeatInput();
});


</script>
</html>